import{a as Q,Q as _}from"./QToolbar-BVmsPAij.js";import{u as F,a as d,b as y,Q as E}from"./useValidationNotification-DJ3O0idh.js";import{Q as B}from"./use-transition-4mtm_1Sm.js";import{Q as l}from"./QInput-Cq_516xi.js";import{Q as D}from"./QCardSection-CkOy_myj.js";import{O as w,P as x,r as f,ag as U,_ as N,S as g,T as p,U as a,V as u,Y as P,X as S,$ as v,W as C}from"./index-B5fKhRmK.js";import{Q as T}from"./QCardActions-c7eJt_Iw.js";import{Q as k}from"./QCard-DxAewxH7.js";import{Q as A}from"./QForm-CDspX6ko.js";import{Q as I,a as q}from"./QInnerLoading-DS7qhBsl.js";import{Q as O}from"./QPage-6isNs5ct.js";import{c as j}from"./images-CvNZJFGB.js";import"./QChip-NOoku7Xo.js";import"./use-dark-CI_1RVc7.js";import"./format-DyQxkAtJ.js";import"./client-eJeKpGNL.js";import"./focus-manager-BJWzFvJg.js";const z=w({__name:"CreatePage",setup(V,{expose:e}){e();const t=x(),r=F("post","/conferences",{title:"",description:"",start_at:"",end_at:"",cover:"",stream_url:"",price:""}),m=f(!1),n=f(null),o=f(null),c={router:t,form:r,loading:m,cover:n,previewCover:o,uploadCover:async()=>{if(n.value){m.value=!0;try{const s=await j(n.value);o.value=s.data,r.cover=s.data.path,d("Обложка успешно загружена","success")}finally{m.value=!1}}},submit:()=>{r.submit().then(()=>{d("Мероприятие успешно создано","success"),t.push("/conferences")}).catch(s=>{const{response:i}=s;if(i.status===422){const{opts:b}=y(i.data);U.create(b.value)}else d(i.data.message,"negative")})},cancel:()=>{t.push("/conferences")}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),G={class:"row q-col-gutter-sm"},L={class:"col-6"},R={class:"col-6"};function W(V,e,t,r,m,n){return g(),p(O,{padding:""},{default:a(()=>[u(_,null,{default:a(()=>[u(Q,null,{default:a(()=>e[14]||(e[14]=[P("Создание нового мероприятия")])),_:1})]),_:1}),u(A,{onSubmit:r.submit,valid:r.form.valid},{default:a(()=>[u(k,null,{default:a(()=>[u(D,null,{default:a(()=>[u(E,{label:"Выберите файл обложки",modelValue:r.cover,"onUpdate:modelValue":[e[0]||(e[0]=o=>r.cover=o),r.uploadCover],filled:"",color:"primary",error:r.form.invalid("cover"),"error-message":r.form.errors.cover,onChange:e[1]||(e[1]=o=>r.form.validate("cover"))},null,8,["modelValue","error","error-message"]),r.previewCover?(g(),p(B,{key:0,src:r.previewCover.url,"spinner-color":"white",class:"q-mb-sm",style:{height:"10rem","max-width":"10rem"}},null,8,["src"])):S("",!0),u(l,{modelValue:r.form.title,"onUpdate:modelValue":e[2]||(e[2]=o=>r.form.title=o),label:"Название мероприятия",error:r.form.invalid("title"),"error-message":r.form.errors.title,onChange:e[3]||(e[3]=o=>r.form.validate("title"))},null,8,["modelValue","error","error-message"]),u(l,{modelValue:r.form.description,"onUpdate:modelValue":e[4]||(e[4]=o=>r.form.description=o),label:"Описание мероприятия",type:"textarea",error:r.form.invalid("description"),"error-message":r.form.errors.description,onChange:e[5]||(e[5]=o=>r.form.validate("description"))},null,8,["modelValue","error","error-message"]),u(l,{modelValue:r.form.stream_url,"onUpdate:modelValue":e[6]||(e[6]=o=>r.form.stream_url=o),label:"Ссылка на трансляцию",error:r.form.invalid("stream_url"),"error-message":r.form.errors.stream_url,onChange:e[7]||(e[7]=o=>r.form.validate("stream_url"))},null,8,["modelValue","error","error-message"]),u(l,{modelValue:r.form.price,"onUpdate:modelValue":e[8]||(e[8]=o=>r.form.price=o),label:"Цена",error:r.form.invalid("price"),"error-message":r.form.errors.price,onChange:e[9]||(e[9]=o=>r.form.validate("price"))},null,8,["modelValue","error","error-message"]),v("div",G,[v("div",L,[u(l,{modelValue:r.form.start_at,"onUpdate:modelValue":e[10]||(e[10]=o=>r.form.start_at=o),label:"Дата начала",type:"datetime-local",error:r.form.invalid("start_at"),"error-message":r.form.errors.start_at,onBlur:e[11]||(e[11]=o=>r.form.validate("start_at"))},null,8,["modelValue","error","error-message"])]),v("div",R,[u(l,{modelValue:r.form.end_at,"onUpdate:modelValue":e[12]||(e[12]=o=>r.form.end_at=o),label:"Дата окончания",type:"datetime-local",error:r.form.invalid("end_at"),"error-message":r.form.errors.end_at,onBlur:e[13]||(e[13]=o=>r.form.validate("end_at"))},null,8,["modelValue","error","error-message"])])])]),_:1}),u(T,null,{default:a(()=>[u(C,{label:"Создать мероприятие",type:"submit",color:"primary",disabled:r.form.processing},null,8,["disabled"]),u(C,{label:"Отмена",color:"secondary",onClick:r.cancel})]),_:1})]),_:1})]),_:1},8,["valid"]),u(q,{showing:r.form.processing},{default:a(()=>[u(I,{size:"5rem",color:"primary"})]),_:1},8,["showing"])]),_:1})}const dr=N(z,[["render",W],["__file","CreatePage.vue"]]);export{dr as default};
