import{a as y,Q as b}from"./QToolbar-fsbRQWuM.js";import{Q as p}from"./QRadio-D7sHEEan.js";import{Q as V}from"./QCardSection-CMAUuuie.js";import{L as C,M as E,N as P,o as k,_ as w,Q as s,R as u,S as r,T as o,W as n,V as i,a1 as g,a2 as B,a3 as F,a4 as I,Z as h}from"./index-Bc0R355J.js";import{a as R,b as v,Q as x}from"./QItem-BlZjPOp4.js";import{Q as D}from"./QList-BbXI1HLq.js";import{Q as A}from"./QBanner-B7nCSk7H.js";import{Q as O}from"./QPagination-DohMD0sg.js";import{Q as L,a as T}from"./QInnerLoading-BHVqACUk.js";import{Q as N}from"./QPage-SQbvXMJf.js";import{g as U}from"./specialists-Bq8c3ZqA.js";import{S as m}from"./StatusEnums-Cpn04w7a.js";import{u as q}from"./stat-store-D9nhWtHV.js";import{I as j}from"./ImageComponent-m-e6C0wA.js";import"./use-dark-B6AwncSa.js";import"./option-sizes-BHbE_qxZ.js";import"./QInput-KLQz9GaB.js";import"./focus-manager-zjdVGI5d.js";import"./format-DyQxkAtJ.js";import"./ImageFullscreen-BMuWzocu.js";const z=C("specialists",{state:()=>({specialists:[],meta:{},currentPage:1,loading:!1,search:"",status:m.OnReview,controller:null}),actions:{async fetchSpecialists(){this.loading&&this.controller&&this.controller.abort(),this.controller=new AbortController,this.loading=!0;try{const l=await U(this.search,this.status,this.currentPage);this.specialists=l.data.data,this.meta=l.data.meta,this.currentPage=this.meta.current_page}catch(l){if(l instanceof Error&&l.name==="AbortError")return}finally{this.controller.signal.aborted||(this.controller=null,this.loading=!1)}}}}),M=E({__name:"IndexPage",setup(l,{expose:a}){a();const d=P(),e=z(),c=q(),_=()=>{e.currentPage=1,e.fetchSpecialists()},t=f=>{e.currentPage=f,e.fetchSpecialists()},S=f=>{d.push({name:"specialists.edit",params:{id:f.id}})};k(()=>{e.specialists.length===0&&(c.specialistsOnReviewCount>0?e.status=m.OnReview:e.status=m.Accepted),e.fetchSpecialists()});const Q={router:d,store:e,statStore:c,applyFilter:_,handlePageChange:t,viewSpecialist:S,get StatusEnum(){return m},ImageComponent:j};return Object.defineProperty(Q,"__isScriptSetup",{enumerable:!1,value:!0}),Q}}),G={key:1,class:"q-mt-md text-center"},W={key:2,class:"q-pa-lg flex flex-center"};function Z(l,a,d,e,c,_){return s(),u(N,{padding:""},{default:r(()=>[o(b,null,{default:r(()=>[o(y,null,{default:r(()=>a[4]||(a[4]=[n("Специалисты")])),_:1})]),_:1}),o(V,{class:"q-mb-md"},{default:r(()=>[e.statStore.specialistsOnReviewCount>0?(s(),u(p,{key:0,modelValue:e.store.status,"onUpdate:modelValue":[a[0]||(a[0]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.OnReview,label:"На проверке"},null,8,["modelValue","val"])):i("",!0),o(p,{modelValue:e.store.status,"onUpdate:modelValue":[a[1]||(a[1]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.Accepted,label:"Проверенные"},null,8,["modelValue","val"]),o(p,{modelValue:e.store.status,"onUpdate:modelValue":[a[2]||(a[2]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.Rejected,label:"Отклоненные"},null,8,["modelValue","val"])]),_:1}),e.store.specialists.length>0?(s(),u(D,{key:0},{default:r(()=>[(s(!0),g(F,null,B(e.store.specialists,t=>(s(),u(R,{onClick:S=>e.viewSpecialist(t),key:t.id,clickable:""},{default:r(()=>[o(v,{avatar:""},{default:r(()=>[o(I,{size:"3rem"},{default:r(()=>[t.photo?.url?(s(),u(e.ImageComponent,{key:0,alt:`${t.name||"Пользователь"}'s avatar`,url:t.photo?.url,"max-width":200,"max-height":200},null,8,["alt","url"])):i("",!0)]),_:2},1024)]),_:2},1024),o(v,null,{default:r(()=>[o(x,{class:"text-h6",lines:"1"},{default:r(()=>[n(h(t.name)+" "+h(t.lastname),1)]),_:2},1024),o(x,{caption:""},{default:r(()=>[n(h(t.middlename),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(s(),g("div",G,[o(A,null,{default:r(()=>a[5]||(a[5]=[n(" Нет специалистов ")])),_:1})])),e.store.meta.last_page>1?(s(),g("div",W,[e.store.meta?(s(),u(O,{key:0,modelValue:e.store.currentPage,"onUpdate:modelValue":[a[3]||(a[3]=t=>e.store.currentPage=t),e.handlePageChange],min:1,max:e.store.meta.last_page,"max-pages":7,"boundary-numbers":""},null,8,["modelValue","max"])):i("",!0)])):i("",!0),o(T,{showing:e.store.loading},{default:r(()=>[o(L,{size:"5rem",color:"primary"})]),_:1},8,["showing"])]),_:1})}const pe=w(M,[["render",Z],["__file","IndexPage.vue"]]);export{pe as default};
