import{a as B,Q as b}from"./QToolbar-CNCw81R0.js";import{Q as f}from"./QRadio-BkxHfoIZ.js";import{Q as y}from"./QCardSection-LiU8wvIw.js";import{a as P,b as S,Q as p}from"./QItem-CSPSlXK2.js";import{Q as x}from"./QList-DzszeXk4.js";import{Q as w}from"./QBanner-D7DUh8es.js";import{Q as D}from"./QPagination-BiE8y08J.js";import{Q as k,a as E}from"./QInnerLoading-CPQATF6z.js";import{Q as C}from"./QPage-C23wwPzr.js";import{L as F,M as R,N as T,o as U,_ as I,Q as l,R as u,S as o,T as a,W as g,V as _,a1 as Q,a2 as L,a3 as A,Z as h,Y as O}from"./index-BIoqSzkr.js";import{g as q}from"./bulletins-CIDRQCW7.js";import{S as i}from"./StatusEnums-Cpn04w7a.js";import{u as N}from"./stat-store-HfXPcyHw.js";import{U as M}from"./UserPhoto-8ASZAP82.js";import{D as j}from"./DateTime-DQmZBOZa.js";import"./use-dark-r3gEVHE7.js";import"./option-sizes-QeK3FBqu.js";import"./QInput-bEU_ILxu.js";import"./focus-manager-BJWzFvJg.js";import"./format-DyQxkAtJ.js";import"./use-transition-BxwYz9Om.js";import"./ImageFullscreen-C2Mk_3OF.js";import"./QDialog-Dt0TXRkh.js";import"./ImageComponent-Ag6g7Cqh.js";import"./date-CRW3--p8.js";const z=F("bulletins",{state:()=>({bulletins:[],meta:{},currentPage:1,loading:!1,status:i.OnReview}),actions:{async fetchBulletins(){this.loading=!0;try{const s=await q(this.status,this.currentPage);this.bulletins=s.data.data,this.meta=s.data.meta,this.currentPage=this.meta.current_page}catch{}finally{this.loading=!1}}}}),H=R({__name:"IndexPage",setup(s,{expose:r}){r();const m=T(),e=z(),d=N(),V=()=>{e.currentPage=1,e.fetchBulletins()},t=c=>{e.currentPage=c,e.fetchBulletins()},n=c=>{m.push({name:"bulletins.show",params:{id:c.id}})};U(()=>{e.bulletins.length===0&&(d.bulletinsOnReviewCount>0?e.status=i.OnReview:e.status=i.Accepted),e.fetchBulletins()});const v={router:m,store:e,statStore:d,applyFilter:V,handlePageChange:t,viewBulletin:n,get StatusEnum(){return i},UserPhoto:M,DateTime:j};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),G=["innerHTML"],W={key:1,class:"q-mt-md text-center"},Y={key:2,class:"q-pa-lg flex flex-center"};function Z(s,r,m,e,d,V){return l(),u(C,{padding:""},{default:o(()=>[a(b,null,{default:o(()=>[a(B,null,{default:o(()=>r[4]||(r[4]=[g("Объявления")])),_:1})]),_:1}),a(y,{class:"q-mb-md"},{default:o(()=>[e.statStore.bulletinsOnReviewCount>0?(l(),u(f,{key:0,modelValue:e.store.status,"onUpdate:modelValue":[r[0]||(r[0]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.OnReview,label:"На проверке"},null,8,["modelValue","val"])):_("",!0),a(f,{modelValue:e.store.status,"onUpdate:modelValue":[r[1]||(r[1]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.Accepted,label:"Проверенные"},null,8,["modelValue","val"]),a(f,{modelValue:e.store.status,"onUpdate:modelValue":[r[2]||(r[2]=t=>e.store.status=t),e.applyFilter],val:e.StatusEnum.Rejected,label:"Отклоненные"},null,8,["modelValue","val"])]),_:1}),e.store.bulletins.length>0?(l(),u(x,{key:0},{default:o(()=>[(l(!0),Q(A,null,L(e.store.bulletins,t=>(l(),u(P,{onClick:n=>e.viewBulletin(t),key:t.id,clickable:""},{default:o(()=>[a(S,{avatar:"",top:""},{default:o(()=>[a(e.UserPhoto,{modelValue:t.creator,"onUpdate:modelValue":n=>t.creator=n,size:"4rem",fullscreen:!1,width:256,height:256},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(S,null,{default:o(()=>[a(p,{class:"q-mb-sm"},{default:o(()=>[g(h(t.creator.name)+" "+h(t.creator.lastname)+" "+h(t.creator.middlename),1)]),_:2},1024),a(p,{class:"q-mb-sm"},{default:o(()=>[O("span",{innerHTML:t.text.replace(/\n/g,"<br>")},null,8,G)]),_:2},1024),a(p,{caption:""},{default:o(()=>[a(e.DateTime,{"raw-date":t.created_at},null,8,["raw-date"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(l(),Q("div",W,[a(w,null,{default:o(()=>r[5]||(r[5]=[g(" Нет объявлений ")])),_:1})])),e.store.meta.last_page>1?(l(),Q("div",Y,[e.store.meta?(l(),u(D,{key:0,modelValue:e.store.currentPage,"onUpdate:modelValue":[r[3]||(r[3]=t=>e.store.currentPage=t),e.handlePageChange],min:1,max:e.store.meta.last_page,"max-pages":7,"boundary-numbers":""},null,8,["modelValue","max"])):_("",!0)])):_("",!0),a(E,{showing:e.store.loading},{default:o(()=>[a(k,{size:"5rem",color:"primary"})]),_:1},8,["showing"])]),_:1})}const Se=I(H,[["render",Z],["__file","IndexPage.vue"]]);export{Se as default};
