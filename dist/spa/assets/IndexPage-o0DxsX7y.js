import{a as Q,Q as v}from"./QToolbar-CNCw81R0.js";import{Q as E}from"./QInput-bEU_ILxu.js";import{a as S,b as h,Q as m}from"./QItem-CSPSlXK2.js";import{Q as f}from"./QBadge-WlIihQSA.js";import{Q as P}from"./QList-DzszeXk4.js";import{Q as x}from"./QBanner-D7DUh8es.js";import{Q as y}from"./QPagination-BiE8y08J.js";import{Q as k,a as V}from"./QInnerLoading-CPQATF6z.js";import{Q as B}from"./QPage-C23wwPzr.js";import{L as C,M as F,N as w,w as L,o as U,_ as I,Q as s,R as n,S as r,T as a,W as u,Y as b,a1 as p,a2 as A,a3 as T,V as i,Z as d}from"./index-BIoqSzkr.js";import{g as D,S as q}from"./SubscriptionLevelEnums-CjGkZn4x.js";import{S as N}from"./StatusEnums-Cpn04w7a.js";import{U as R}from"./UserPhoto-8ASZAP82.js";import{D as z}from"./DateTime-DQmZBOZa.js";import"./use-dark-r3gEVHE7.js";import"./focus-manager-BJWzFvJg.js";import"./format-DyQxkAtJ.js";import"./use-transition-BxwYz9Om.js";import"./ImageFullscreen-C2Mk_3OF.js";import"./QDialog-Dt0TXRkh.js";import"./ImageComponent-Ag6g7Cqh.js";import"./date-CRW3--p8.js";const M=C("users",{state:()=>({users:[],meta:{},currentPage:1,loading:!1,status:N.OnReview,search:"",controller:null}),actions:{async fetchUsers(){this.loading&&this.controller&&this.controller.abort(),this.controller=new AbortController,this.loading=!0;try{const l=await D(this.search,this.currentPage,{signal:this.controller.signal});this.users=l.data.data,this.meta=l.data.meta,this.currentPage=this.meta.current_page}catch(l){if(l instanceof Error&&l.name==="AbortError")return}finally{this.controller.signal.aborted||(this.controller=null,this.loading=!1)}},cancelFetch(){this.controller&&(this.controller.abort(),this.controller=null)}}}),O=F({__name:"IndexPage",setup(l,{expose:o}){o();const g=w(),e=M(),_=t=>{e.currentPage=t,e.fetchUsers()};L(()=>e.search,()=>{e.fetchUsers()}),U(()=>{e.fetchUsers()});const c={router:g,store:e,handlePageChange:_,UserPhoto:R,get SubscriptionLevelEnums(){return q},DateTime:z};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),j={class:"q-gutter-sm q-mb-md q-mx-sm"},G={class:"relative-position"},W={key:1,class:"q-mt-md text-center"},Y={key:2,class:"q-pa-lg flex flex-center"};function Z(l,o,g,e,_,c){return s(),n(B,{padding:""},{default:r(()=>[a(v,null,{default:r(()=>[a(Q,null,{default:r(()=>o[2]||(o[2]=[u("Пользователи")])),_:1})]),_:1}),b("div",j,[a(E,{modelValue:e.store.search,"onUpdate:modelValue":o[0]||(o[0]=t=>e.store.search=t),debounce:"500",loading:e.store.loading},null,8,["modelValue","loading"])]),b("div",G,[e.store.users.length>0?(s(),n(P,{key:0,separator:""},{default:r(()=>[(s(!0),p(T,null,A(e.store.users,t=>(s(),n(S,{onClick:H=>e.router.push({name:"users.edit",params:{id:t.id}}),key:t.id,clickable:""},{default:r(()=>[a(h,{avatar:""},{default:r(()=>[a(e.UserPhoto,{modelValue:t,size:"3rem",width:256,height:256},null,8,["modelValue"])]),_:2},1024),a(h,null,{default:r(()=>[a(m,null,{default:r(()=>[u(d(t.name)+" "+d(t.lastname)+" "+d(t.middlename),1)]),_:2},1024),a(m,{caption:""},{default:r(()=>[u(d(t.email),1)]),_:2},1024),a(m,null,{default:r(()=>[t.subscription_level==e.SubscriptionLevelEnums.ParentsAndRelated?(s(),n(f,{key:0,label:"Подписка A"})):i("",!0),t.subscription_level==e.SubscriptionLevelEnums.Specialists?(s(),n(f,{key:1,label:"Подписка B"})):i("",!0),t.subscription_level==e.SubscriptionLevelEnums.Centers?(s(),n(f,{key:2,label:"Подписка C"})):i("",!0)]),_:2},1024),t.subscription_level!=e.SubscriptionLevelEnums.Free?(s(),n(m,{key:0},{default:r(()=>[o[3]||(o[3]=u(" Продлена до ")),a(e.DateTime,{"raw-date":t.subscription_ends_at},null,8,["raw-date"])]),_:2},1024)):i("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(s(),p("div",W,[a(x,null,{default:r(()=>o[4]||(o[4]=[u(" Нет пользователей ")])),_:1})])),e.store.meta.last_page>1?(s(),p("div",Y,[e.store.meta?(s(),n(y,{key:0,modelValue:e.store.currentPage,"onUpdate:modelValue":[o[1]||(o[1]=t=>e.store.currentPage=t),e.handlePageChange],min:1,max:e.store.meta.last_page,"max-pages":7,"boundary-numbers":""},null,8,["modelValue","max"])):i("",!0)])):i("",!0),a(V,{showing:e.store.loading},{default:r(()=>[a(k,{size:"5rem",color:"primary"})]),_:1},8,["showing"])])]),_:1})}const be=I(O,[["render",Z],["__file","IndexPage.vue"]]);export{be as default};
